<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UniRec: IP prefix binary search</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UniRec
   &#160;<span id="projectnumber">2.9.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IP prefix binary search </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This structure is an ordered array data structure that is used to store a dynamic set, where the keys are low and high IP addresses of prefix. Binary search compares low and high IP with the searched IP address and returns data associated with match prefix.</p>
<p>The prefix array can be used for storing any data (string, int). For example, it can be used to aggregate information from multiple blacklists. Data type is specific to each user and their source format (source file, delimiters, data format or data length,...), so user MUST define <code>function load_networks()</code>, which load and parse information, and data about networks from any of their source and fill <code>'ipps_network_list'</code> structure.</p>
<p>Before using the search, call the <code><a class="el" href="ip__prefix__search_8c.html#af6d245a01b1d56b1969ff5b05ef9c8db">ipps_init()</a></code> function. The function creates all necessary structures for storing and accessing the data and return structure of IPv4 and IPv6 array of prefixes with data (network context).</p>
<p>The parameters are:</p><ul>
<li>Structure with networks array and networks counter</li>
</ul>
<p>For searching, use the function <code><a class="el" href="ip__prefix__search_8c.html#a8565d4f3b5945285e6318356fbb69477">ipps_search()</a></code>. Function returns number of data associated with match prefix and return pointer to data as parameter:</p>
<ul>
<li>Structure of ip prefix context, <a class="el" href="ip__prefix__search_8h.html#structipps__context__t">ipps_context_t</a></li>
<li>IP address union</li>
<li>Void pointer to data array</li>
</ul>
<p>For example, if blacklist contains:</p>
<div class="fragment"><div class="line">192.168.1.0/24   aaa</div><div class="line">192.168.1.0/25   bbb</div><div class="line">192.168.1.128/25 ccc</div></div><!-- fragment --><div class="fragment"><div class="line">{init()```}</div><div class="line">* From 1.0 to 1.127 with data &quot;aaa&quot; and &quot;bbb&quot;</div><div class="line">* From 1.128 to 1.255 with data &quot;aaa&quot; and &quot;ccc&quot;:</div></div><!-- fragment --><p> 192.168.1.0 192.168.1.255 ↓ ↓ &lt;--&mdash;aaa-&mdash;&gt; &lt;-bbb-&gt;&lt;-ccc-&gt; </p><div class="fragment"><div class="line">and ```ip_prefix_search()``` is called with 192.168.1.100, search return number 2 and pointer to data &quot;aaa&quot; and &quot;bbb&quot;.</div><div class="line">For 192.168.1.200, return also number 2 but data are &quot;aaa&quot; and &quot;ccc&quot;. For 192.1.1.1, search return 0 and pointer</div><div class="line">to data is not fill.</div><div class="line"></div><div class="line">For destruction of a whole structure and data there is ```ipps_destroy()``` function, parameter is pointer to</div><div class="line">the ```ipps_context_t structure```, that has to be destroyed. Also, a list of networks is necessary to destroy with</div><div class="line">function ```destroy_networks()``` (this function isn&#39;t a part of library and the user must define it).</div><div class="line"></div><div class="line">Recommended control flow is:</div><div class="line">1. ```load_networks(</div></div><!-- fragment --><ol type="1">
<li><code><a class="el" href="ip__prefix__search_8c.html#af6d245a01b1d56b1969ff5b05ef9c8db">ipps_init()</a></code></li>
<li><code>destroy_networks()</code></li>
<li><code><a class="el" href="ip__prefix__search_8c.html#a8565d4f3b5945285e6318356fbb69477">ipps_search()</a></code></li>
<li><code><a class="el" href="ip__prefix__search_8c.html#a03c39a2163d96fe9694ae39255f17e3e">ipps_destroy()</a></code></li>
</ol>
<hr/>
<h2>Example file</h2>
<p>``` /**</p><ul>
<li></li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
